# Import bibliotek i danych

```{r}
library(ggplot2)
library(gridExtra)

diamonds <- read.csv('diamonds.csv',colClasses=c(X='NULL'))
```

# Analiza eksploracyjna

```{r}
str(diamonds)
nrow(diamonds)
sum(is.na(diamonds)) # brak NA
```

## Wstępne przekształcenia zmiennych

```{r}
diamonds$cut <- factor(diamonds$cut)
diamonds$color <- factor(diamonds$color)
diamonds$clarity <- factor(diamonds$clarity)

diamonds$volume <- diamonds$x * diamonds$y * diamonds$z

```

## Zależność wagi (w karatach) od ceny

```{r}
ggplot(diamonds, aes(carat, price))+
  geom_point()+
  geom_smooth(method='lm')
```

Na powyższym wykresie widoczna jest zależność co najmniej liniowa ceny od wagi.

Do wykresu możemy uwzględnić różne zmienne, kolorując odpowiednio poszczególne wyniki:

```{r}

plot1_color <- ggplot(diamonds, aes(carat, price,color=color))+
  geom_point()
plot1_cut <- ggplot(diamonds, aes(carat, price,color=cut))+
  geom_point()
plot1_clarity <- ggplot(diamonds, aes(carat, price,color=clarity))+
  geom_point()

grid.arrange(plot1_color,plot1_cut,plot1_clarity,nrow=3)
```

Widać dość wyraźny podział na klasy w zależności od przejrzystości oraz lekki podział ze względu na kolor.

## Sprawdzanie podziałów diamentów na klasy

Sprawdzimy cenę poszczególnych klas przejrzystości:

```{r}
ggplot(diamonds,aes(clarity,price,fill=clarity))+
  geom_boxplot()
```

Jak widać cena ma pewną zależność od przejrzystości. Problemem może być jednak waga samego diamentu, która może być nieproporcjonalna dla różnych klas przejrzystości. Zdefiniujemy zatem nową zmienną, która objaśniać będzie cenę diamentu za karat.

```{r}
diamonds$price_carat <- diamonds$price / diamonds$carat
ggplot(diamonds,aes(clarity,price_carat,fill=clarity))+
  geom_boxplot()
```

Cena za karat jednak nie różni się na tyle znacząco, by stwierdzić iż zależy od przejrzystości.

Sprawdźmy jak wygląda sytuacja dla zmiennej 'color'

```{r}
boxplot_color_price <- ggplot(diamonds,aes(color,price,fill=color))+
  geom_boxplot()
boxplot_color_cprice <- ggplot(diamonds,aes(color,price_carat,fill=color))+
  geom_boxplot()

grid.arrange(boxplot_color_price,boxplot_color_cprice,nrow=2)
```

Widać pewną zależność ceny od koloru. Brak jakiejkolwiek zależności dla ceny za karat od koloru. Stąd nasza pierwsza hipoteza będzie następująca:

#hipoteza 1: Diamenty koloru J są średnio ponad 2 razy cięższe od diamentów koloru D.

Sprawdźmy jak sytuacja wygląda w przypadku różnego rodzaju cięcia.

```{r}
boxplot_cut_price<-ggplot(diamonds,aes(cut,price,fill=cut))+
  geom_boxplot()
boxplot_cut_cprice<-ggplot(diamonds,aes(cut,price_carat,fill=cut))+
  geom_boxplot()

grid.arrange(boxplot_cut_price,boxplot_cut_cprice,nrow=2)
```

Widać lekkie odchylenie ceny w zależności od rodzaju wycięcia.

Brak widocznej zależności dla ceny za karat.

## Kolor a waga diamentu

```{r}
ggplot(diamonds, aes(color, carat, fill=color)) +
  labs(title='Wykres pudełkowy `') +
  xlab('`table_group`') +
  ylab('Karat') +
  geom_boxplot()
```

# Hipoteza 2: waga diamentu zależy od koloru

```{r}
ggplot(diamonds, aes(clarity, carat,fill=clarity))+
  geom_boxplot()
```

# hipoteza 3 moze cos powiazane z przejrzystoscia l1 oraz kolorem j?

Diamenty z kolorem J oraz poziomem przejrzystości l1 będą miały najwyższą średnią cenę

```{r}
#jakos to sprawdzic
```

# Sprawdzanie hipotez

## Hipoteza nr 1: Diamenty koloru J są średnio ponad 2 razy cięższe od diamentów koloru D.

```{r}
diamonds_J <- subset(diamonds,color=='J')
diamonds_D <- subset(diamonds,color=='D')

t.test(diamonds_J$carat,mu = mean(diamonds_D$carat)*2,alternative = 'greater')
```

Hipoteza H1 odrzucona, diamenty koloru J wydają się mieć mniejszą średnią wagę niż dwukrotność średniej wagi diamentu koloru D.
